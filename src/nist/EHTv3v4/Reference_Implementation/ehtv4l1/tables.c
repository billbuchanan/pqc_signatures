#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>

/**
 * A 3D boolean array representing a certain ordering of all group elements of GL(3,2).
 * The ordering is in ascending order in its decimal representation with the identity matrix moved up to the first position.
 * The General Linear group GL(3,2) is the set of all invertible 3x3 matrices over the finite field with 2 elements. 
 * This array stores all 168 such matrices.
 *
 * The dimensions are as follows:
 * - 168: Represents the total number of invertible 3x3 binary matrices.
 * - 3: The second dimension of the array represents the rows in a 3x3 matrix.
 * - 3: The third dimension represents the columns in a 3x3 matrix.
 */
const bool GL_3_2[168][3][3] =
{{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}, {{0, 0, 1}, {0, 1, 0}, {1, 0, 0}}, {{0, 0, 1}, {0, 1, 0}, {1, 0, 1}}, {{0, 0, 1}, {0, 1, 0}, {1, 1, 0}}, {{0, 0, 1}, {0, 1, 0}, {1, 1, 1}}, {{0, 0, 1}, {0, 1, 1}, {1, 0, 0}},
{{0, 0, 1}, {0, 1, 1}, {1, 0, 1}}, {{0, 0, 1}, {0, 1, 1}, {1, 1, 0}}, {{0, 0, 1}, {0, 1, 1}, {1, 1, 1}}, {{0, 0, 1}, {1, 0, 0}, {0, 1, 0}}, {{0, 0, 1}, {1, 0, 0}, {0, 1, 1}}, {{0, 0, 1}, {1, 0, 0}, {1, 1, 0}},
{{0, 0, 1}, {1, 0, 0}, {1, 1, 1}}, {{0, 0, 1}, {1, 0, 1}, {0, 1, 0}}, {{0, 0, 1}, {1, 0, 1}, {0, 1, 1}}, {{0, 0, 1}, {1, 0, 1}, {1, 1, 0}}, {{0, 0, 1}, {1, 0, 1}, {1, 1, 1}}, {{0, 0, 1}, {1, 1, 0}, {0, 1, 0}},
{{0, 0, 1}, {1, 1, 0}, {0, 1, 1}}, {{0, 0, 1}, {1, 1, 0}, {1, 0, 0}}, {{0, 0, 1}, {1, 1, 0}, {1, 0, 1}}, {{0, 0, 1}, {1, 1, 1}, {0, 1, 0}}, {{0, 0, 1}, {1, 1, 1}, {0, 1, 1}}, {{0, 0, 1}, {1, 1, 1}, {1, 0, 0}},
{{0, 0, 1}, {1, 1, 1}, {1, 0, 1}}, {{0, 1, 0}, {0, 0, 1}, {1, 0, 0}}, {{0, 1, 0}, {0, 0, 1}, {1, 0, 1}}, {{0, 1, 0}, {0, 0, 1}, {1, 1, 0}}, {{0, 1, 0}, {0, 0, 1}, {1, 1, 1}}, {{0, 1, 0}, {0, 1, 1}, {1, 0, 0}},
{{0, 1, 0}, {0, 1, 1}, {1, 0, 1}}, {{0, 1, 0}, {0, 1, 1}, {1, 1, 0}}, {{0, 1, 0}, {0, 1, 1}, {1, 1, 1}}, {{0, 1, 0}, {1, 0, 0}, {0, 0, 1}}, {{0, 1, 0}, {1, 0, 0}, {0, 1, 1}}, {{0, 1, 0}, {1, 0, 0}, {1, 0, 1}},
{{0, 1, 0}, {1, 0, 0}, {1, 1, 1}}, {{0, 1, 0}, {1, 0, 1}, {0, 0, 1}}, {{0, 1, 0}, {1, 0, 1}, {0, 1, 1}}, {{0, 1, 0}, {1, 0, 1}, {1, 0, 0}}, {{0, 1, 0}, {1, 0, 1}, {1, 1, 0}}, {{0, 1, 0}, {1, 1, 0}, {0, 0, 1}},
{{0, 1, 0}, {1, 1, 0}, {0, 1, 1}}, {{0, 1, 0}, {1, 1, 0}, {1, 0, 1}}, {{0, 1, 0}, {1, 1, 0}, {1, 1, 1}}, {{0, 1, 0}, {1, 1, 1}, {0, 0, 1}}, {{0, 1, 0}, {1, 1, 1}, {0, 1, 1}}, {{0, 1, 0}, {1, 1, 1}, {1, 0, 0}},
{{0, 1, 0}, {1, 1, 1}, {1, 1, 0}}, {{0, 1, 1}, {0, 0, 1}, {1, 0, 0}}, {{0, 1, 1}, {0, 0, 1}, {1, 0, 1}}, {{0, 1, 1}, {0, 0, 1}, {1, 1, 0}}, {{0, 1, 1}, {0, 0, 1}, {1, 1, 1}}, {{0, 1, 1}, {0, 1, 0}, {1, 0, 0}},
{{0, 1, 1}, {0, 1, 0}, {1, 0, 1}}, {{0, 1, 1}, {0, 1, 0}, {1, 1, 0}}, {{0, 1, 1}, {0, 1, 0}, {1, 1, 1}}, {{0, 1, 1}, {1, 0, 0}, {0, 0, 1}}, {{0, 1, 1}, {1, 0, 0}, {0, 1, 0}}, {{0, 1, 1}, {1, 0, 0}, {1, 0, 1}},
{{0, 1, 1}, {1, 0, 0}, {1, 1, 0}}, {{0, 1, 1}, {1, 0, 1}, {0, 0, 1}}, {{0, 1, 1}, {1, 0, 1}, {0, 1, 0}}, {{0, 1, 1}, {1, 0, 1}, {1, 0, 0}}, {{0, 1, 1}, {1, 0, 1}, {1, 1, 1}}, {{0, 1, 1}, {1, 1, 0}, {0, 0, 1}},
{{0, 1, 1}, {1, 1, 0}, {0, 1, 0}}, {{0, 1, 1}, {1, 1, 0}, {1, 0, 0}}, {{0, 1, 1}, {1, 1, 0}, {1, 1, 1}}, {{0, 1, 1}, {1, 1, 1}, {0, 0, 1}}, {{0, 1, 1}, {1, 1, 1}, {0, 1, 0}}, {{0, 1, 1}, {1, 1, 1}, {1, 0, 1}},
{{0, 1, 1}, {1, 1, 1}, {1, 1, 0}}, {{1, 0, 0}, {0, 0, 1}, {0, 1, 0}}, {{1, 0, 0}, {0, 0, 1}, {0, 1, 1}}, {{1, 0, 0}, {0, 0, 1}, {1, 1, 0}}, {{1, 0, 0}, {0, 0, 1}, {1, 1, 1}}, {{1, 0, 0}, {0, 1, 0}, {0, 1, 1}},
{{1, 0, 0}, {0, 1, 0}, {1, 0, 1}}, {{1, 0, 0}, {0, 1, 0}, {1, 1, 1}}, {{1, 0, 0}, {0, 1, 1}, {0, 0, 1}}, {{1, 0, 0}, {0, 1, 1}, {0, 1, 0}}, {{1, 0, 0}, {0, 1, 1}, {1, 0, 1}}, {{1, 0, 0}, {0, 1, 1}, {1, 1, 0}},
{{1, 0, 0}, {1, 0, 1}, {0, 1, 0}}, {{1, 0, 0}, {1, 0, 1}, {0, 1, 1}}, {{1, 0, 0}, {1, 0, 1}, {1, 1, 0}}, {{1, 0, 0}, {1, 0, 1}, {1, 1, 1}}, {{1, 0, 0}, {1, 1, 0}, {0, 0, 1}}, {{1, 0, 0}, {1, 1, 0}, {0, 1, 1}},
{{1, 0, 0}, {1, 1, 0}, {1, 0, 1}}, {{1, 0, 0}, {1, 1, 0}, {1, 1, 1}}, {{1, 0, 0}, {1, 1, 1}, {0, 0, 1}}, {{1, 0, 0}, {1, 1, 1}, {0, 1, 0}}, {{1, 0, 0}, {1, 1, 1}, {1, 0, 1}}, {{1, 0, 0}, {1, 1, 1}, {1, 1, 0}},
{{1, 0, 1}, {0, 0, 1}, {0, 1, 0}}, {{1, 0, 1}, {0, 0, 1}, {0, 1, 1}}, {{1, 0, 1}, {0, 0, 1}, {1, 1, 0}}, {{1, 0, 1}, {0, 0, 1}, {1, 1, 1}}, {{1, 0, 1}, {0, 1, 0}, {0, 0, 1}}, {{1, 0, 1}, {0, 1, 0}, {0, 1, 1}},
{{1, 0, 1}, {0, 1, 0}, {1, 0, 0}}, {{1, 0, 1}, {0, 1, 0}, {1, 1, 0}}, {{1, 0, 1}, {0, 1, 1}, {0, 0, 1}}, {{1, 0, 1}, {0, 1, 1}, {0, 1, 0}}, {{1, 0, 1}, {0, 1, 1}, {1, 0, 0}}, {{1, 0, 1}, {0, 1, 1}, {1, 1, 1}},
{{1, 0, 1}, {1, 0, 0}, {0, 1, 0}}, {{1, 0, 1}, {1, 0, 0}, {0, 1, 1}}, {{1, 0, 1}, {1, 0, 0}, {1, 1, 0}}, {{1, 0, 1}, {1, 0, 0}, {1, 1, 1}}, {{1, 0, 1}, {1, 1, 0}, {0, 0, 1}}, {{1, 0, 1}, {1, 1, 0}, {0, 1, 0}},
{{1, 0, 1}, {1, 1, 0}, {1, 0, 0}}, {{1, 0, 1}, {1, 1, 0}, {1, 1, 1}}, {{1, 0, 1}, {1, 1, 1}, {0, 0, 1}}, {{1, 0, 1}, {1, 1, 1}, {0, 1, 1}}, {{1, 0, 1}, {1, 1, 1}, {1, 0, 0}}, {{1, 0, 1}, {1, 1, 1}, {1, 1, 0}},
{{1, 1, 0}, {0, 0, 1}, {0, 1, 0}}, {{1, 1, 0}, {0, 0, 1}, {0, 1, 1}}, {{1, 1, 0}, {0, 0, 1}, {1, 0, 0}}, {{1, 1, 0}, {0, 0, 1}, {1, 0, 1}}, {{1, 1, 0}, {0, 1, 0}, {0, 0, 1}}, {{1, 1, 0}, {0, 1, 0}, {0, 1, 1}},
{{1, 1, 0}, {0, 1, 0}, {1, 0, 1}}, {{1, 1, 0}, {0, 1, 0}, {1, 1, 1}}, {{1, 1, 0}, {0, 1, 1}, {0, 0, 1}}, {{1, 1, 0}, {0, 1, 1}, {0, 1, 0}}, {{1, 1, 0}, {0, 1, 1}, {1, 0, 0}}, {{1, 1, 0}, {0, 1, 1}, {1, 1, 1}},
{{1, 1, 0}, {1, 0, 0}, {0, 0, 1}}, {{1, 1, 0}, {1, 0, 0}, {0, 1, 1}}, {{1, 1, 0}, {1, 0, 0}, {1, 0, 1}}, {{1, 1, 0}, {1, 0, 0}, {1, 1, 1}}, {{1, 1, 0}, {1, 0, 1}, {0, 0, 1}}, {{1, 1, 0}, {1, 0, 1}, {0, 1, 0}},
{{1, 1, 0}, {1, 0, 1}, {1, 0, 0}}, {{1, 1, 0}, {1, 0, 1}, {1, 1, 1}}, {{1, 1, 0}, {1, 1, 1}, {0, 1, 0}}, {{1, 1, 0}, {1, 1, 1}, {0, 1, 1}}, {{1, 1, 0}, {1, 1, 1}, {1, 0, 0}}, {{1, 1, 0}, {1, 1, 1}, {1, 0, 1}},
{{1, 1, 1}, {0, 0, 1}, {0, 1, 0}}, {{1, 1, 1}, {0, 0, 1}, {0, 1, 1}}, {{1, 1, 1}, {0, 0, 1}, {1, 0, 0}}, {{1, 1, 1}, {0, 0, 1}, {1, 0, 1}}, {{1, 1, 1}, {0, 1, 0}, {0, 0, 1}}, {{1, 1, 1}, {0, 1, 0}, {0, 1, 1}},
{{1, 1, 1}, {0, 1, 0}, {1, 0, 0}}, {{1, 1, 1}, {0, 1, 0}, {1, 1, 0}}, {{1, 1, 1}, {0, 1, 1}, {0, 0, 1}}, {{1, 1, 1}, {0, 1, 1}, {0, 1, 0}}, {{1, 1, 1}, {0, 1, 1}, {1, 0, 1}}, {{1, 1, 1}, {0, 1, 1}, {1, 1, 0}},
{{1, 1, 1}, {1, 0, 0}, {0, 0, 1}}, {{1, 1, 1}, {1, 0, 0}, {0, 1, 0}}, {{1, 1, 1}, {1, 0, 0}, {1, 0, 1}}, {{1, 1, 1}, {1, 0, 0}, {1, 1, 0}}, {{1, 1, 1}, {1, 0, 1}, {0, 0, 1}}, {{1, 1, 1}, {1, 0, 1}, {0, 1, 1}},
{{1, 1, 1}, {1, 0, 1}, {1, 0, 0}}, {{1, 1, 1}, {1, 0, 1}, {1, 1, 0}}, {{1, 1, 1}, {1, 1, 0}, {0, 1, 0}}, {{1, 1, 1}, {1, 1, 0}, {0, 1, 1}}, {{1, 1, 1}, {1, 1, 0}, {1, 0, 0}}, {{1, 1, 1}, {1, 1, 0}, {1, 0, 1}}};

/**
 * An array serving as a lookup table to map the decimal values of the elements in the GL(3,2) group to their indices 
 * in the ordered set of the group (i.e., from const bool GL_3_2[168][3][3]).
 * 
 * This table allows for quick index lookup as compared to a linear lookup
 * 
 * The array has a size of 512, since a 3x3 binary matrix can represent a number from 0 to 511 in decimal (2^9 - 1) 
 * [in this case the decimal is determined in reverse, e.g., (011) is 6 and not 3]. 
 * Therefore, this array covers all the possible binary representations of a 3x3 matrix.
 *
 * Each index of the array corresponds to a decimal value of a 3x3 binary matrix. 
 * The value at each index corresponds to the index of that matrix in the ordered set of the GL(3,2) group. 
 * If the decimal value does not correspond to an element in the GL(3,2) group, then the value is 168, 
 * indicating an invalid or non-invertible matrix (since there are only 168 invertible 3x3 binary matrices).
 */
const unsigned char lookup_GL_3_2[512] =
{168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,
 168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,
 168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,1,102,53,150,168,168,168,168,19,114,67,166,
 168,168,25,122,168,168,49,146,168,168,39,138,168,168,63,162,168,168,29,130,5,106,168,168,168,168,47,142,23,118,168,168,
 168,168,168,168,168,168,168,168,168,168,168,168,9,108,58,157,168,168,168,168,168,168,168,168,168,168,168,168,17,113,66,164,
 168,73,168,120,168,96,168,144,168,84,168,137,13,168,62,168,168,81,168,129,168,105,168,153,168,93,168,140,21,168,70,168,
 168,168,168,168,168,168,168,168,168,168,168,168,11,110,60,159,168,168,168,168,3,103,55,151,168,168,168,168,168,168,168,168,
 168,75,27,168,168,98,51,168,168,86,40,168,15,168,168,163,168,83,31,168,7,168,168,155,168,95,48,168,168,119,72,168,
 168,168,168,168,168,168,168,168,168,168,33,132,168,168,57,156,168,0,168,124,168,100,168,148,168,88,41,168,168,112,65,168,
 168,168,168,168,168,168,168,168,168,168,37,136,168,168,61,160,168,80,168,128,168,104,168,152,168,92,45,168,168,116,69,168,
 168,168,168,168,168,168,168,168,168,168,35,134,168,168,59,158,168,78,168,126,2,168,54,168,168,90,43,168,20,168,168,167,
 168,168,26,123,168,168,50,147,168,168,168,168,168,168,168,168,168,82,30,168,6,168,168,154,168,94,168,143,24,168,71,168,
 168,168,168,168,168,168,168,168,168,168,34,133,10,109,168,168,168,77,168,125,168,101,168,149,168,89,42,168,18,168,168,165,
 168,74,168,121,168,97,168,145,168,85,38,168,14,168,168,161,168,168,168,168,168,168,168,168,168,168,46,141,22,117,168,168,
 168,168,168,168,168,168,168,168,168,168,36,135,12,111,168,168,168,79,168,127,4,168,56,168,168,91,44,168,168,115,68,168,
 168,76,28,168,168,99,52,168,168,87,168,139,16,168,64,168,168,168,32,131,8,107,168,168,168,168,168,168,168,168,168,168};

