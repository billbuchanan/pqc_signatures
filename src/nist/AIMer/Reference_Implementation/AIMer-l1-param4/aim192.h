// -----------------------------------------------------------------------------
// File Name   : aim192.h
// Description : 
// SPDX-License-Identifier: MIT
// -----------------------------------------------------------------------------

#ifndef AIM192_H
#define AIM192_H

#include "field/field.h"

#define NUM_INPUT_SBOX      2   // number of input S-box
#define BLOCK_SIZE         24   // block size of AIM
#define TAPE_LEN         4752   // tape length of matrix generation

static const GF e2_power_matrix[192] = {
  {0x0000000000000001, 0x0000000000000000, 0x0000000000000000},
  {0x3b9727c5be851974, 0xf517af2579acb58f, 0x6dd9a0ef6f8ba4a8},
  {0x66a3cdd9f66804d1, 0x424fa26dd046adfa, 0x505f5234993ac774},
  {0x4e39a3c06a6743c6, 0xfb9ea3bc76801801, 0x8e2ce75ba3201ce7},
  {0x27004f48de06100e, 0x7251fcf0eab0b239, 0xa608cc37b14fc615},
  {0xfb620989ed322765, 0x02645c92253691ad, 0x645487b8d08b0e13},
  {0x1c3e789acebd32c3, 0xcecd1941ea9ef6c0, 0xfeba759ba7a3d479},
  {0xabeee3b9050f4cfc, 0x9217d4168e44db04, 0x78fa8cc076a75f4a},
  {0xb840f7b8039b3a3d, 0x5f9a5b02aa399fbd, 0x822864e9dcb69489},
  {0xbcefb49f5bd5cf14, 0x414b4c5a15dfed88, 0x30310e28d96643df},
  {0x5647617cda84543b, 0x6264f75f2bedc5da, 0x6069fa458bc93eb8},
  {0xea141074dbf02e2a, 0x664d1c8a6813debe, 0xb608c9b4f865cf10},
  {0xcbd1dc66a34b35d3, 0xd798dbe62a3a8b2a, 0x54cb3982b6c23478},
  {0x543fc0999af4d5ab, 0x2ccbfd323fa38734, 0x0d03506eede4f3a3},
  {0x450d8d972f20dd0a, 0xa50a82b7882616bc, 0x8abf18edb8dcb01a},
  {0x3857d4804a40b3d8, 0x7f272ca8ff9ac61e, 0x928d91e51a843f7b},
  {0xdc0f2591d11f172a, 0x5bd3414d1a44a40f, 0x865a388b250ec83f},
  {0x0b93c295b2ef08e4, 0x2a5bd3e8cd63c4e5, 0x516bdde0d7841caa},
  {0x61ca024209edd4c2, 0x531d323137a25d76, 0x9a13cad27fff7da9},
  {0x4d047b3279032cf9, 0x6d76cbbd2cf9bd9a, 0xd332a4196cda1955},
  {0x3f52244b30f3dc58, 0xf2668150a48e6f9a, 0x684f193d58c52992},
  {0x1678ebcacc45bc92, 0xb39633f6fb242409, 0x9ffd98e089d4e896},
  {0x37210c37aac5f6f1, 0x5e8e65ce9a2b921a, 0x452c20ecc030160f},
  {0x4b04db0e76fffd9e, 0x107925ef06edb8c3, 0xafa44c93b0800bea},
  {0x79cf76ac1161f351, 0x0100e31fc22adefd, 0xfb1d961dfa23c67b},
  {0x070551e04cd901dc, 0xdb36b3ea1c3aee70, 0x8f0a9c5a550b8ff7},
  {0x74ddc6605324dd59, 0x940ca10e79b89fd8, 0x2c624696b71f4297},
  {0xabb3d4665d03ba76, 0x3dc4727a026bd8bb, 0x7cf0522eafebca79},
  {0xd0a227fd936e41c8, 0x6af81ec21b51e5ea, 0xa3bf743fa7ffc044},
  {0x1ace8c9d687d7725, 0x1bfb1cab9371d87e, 0xe2addc7ff91cc087},
  {0xd06d06e97096bce7, 0xa1bdd967e1318851, 0x1068a85217b8a5a3},
  {0x1d196226d307471e, 0xe3e6401de22971c7, 0xb23be385ea91fd43},
  {0x857334c6719a4d14, 0x45a72bd095d3f122, 0xcb20c4cefef1e30c},
  {0x81b51627d21fed19, 0xa53a5dac7a6267f0, 0xbb197d4f1c11fbf7},
  {0x7ad0802735f0dde8, 0x3d8f8975fe97becf, 0xa7dc5b774e0cf838},
  {0x9ed22a3704e3424e, 0x031e5ea2681b3ff8, 0xa3acd9e4d4ecb29f},
  {0xf5dafa64c80edbe4, 0xd4015065c210ed4b, 0x61c9c1b682a42002},
  {0x9e128b6f42d8c345, 0xa824d455bdd741fb, 0xda140075cbf67ad1},
  {0x507ce14097283329, 0x55c814ccb30afaf9, 0x31c9cc7e9121e709},
  {0x8de3e4222f482ea9, 0xd0ae817de2ec4f39, 0x45b361a6af3de578},
  {0x2c16334891dfe376, 0xd3bca9f139765572, 0x09d81b7fb210f37b},
  {0x93ab8d59c607a1ce, 0x37af489d8243dd6f, 0xae6796c8067208c8},
  {0x09ea5d7fdce0700f, 0xe07a2a1bd9a41d0b, 0x3945060662fbac60},
  {0xc4dc03baa0aa0f32, 0x40471636d2914011, 0x05a62513a891a459},
  {0x98c9bbb731caca95, 0xb5179f018d3c2e36, 0x39b131f75d2f84dd},
  {0x663d497df239d557, 0x9b131bbbd961b343, 0x05312af2ba96c27b},
  {0x921e9f10418dd716, 0x4b64c01072358f88, 0xf71c80291cd115bd},
  {0x0bebb26fe275011a, 0x95c5b2ffffd8b7ed, 0xaeb0f28176d07384},
  {0x0186142afb9ea87b, 0x1d9f4ee7af728c0b, 0x585faa521c38fb4d},
  {0x5121c9b65a45467f, 0x4d1ffa9641876c43, 0x5d6a362576f0fad3},
  {0x0409c00e59b1ceeb, 0xffe2236bfa0175c2, 0xea7b26b93aecc1d4},
  {0xcef61045c7d9114d, 0xbc57341adf624f12, 0xb6ff81b4054ef821},
  {0x5e752d838dd63be3, 0x44fbfd72222959ca, 0x20fb2b543b181c0f},
  {0xd36970a4a3d734fe, 0x8dffec337b5ec576, 0x34582f9703e5d365},
  {0xa34fb87fac52d8fe, 0xb345ca77c2c6de51, 0xc29f3f4da45e72ca},
  {0x5abea01f2df62c97, 0x2893214a5da51461, 0xcf1e4c8efde32495},
  {0x0ef21e94bc84f335, 0x87c04406b41d2d2b, 0xdffd6120b763e44c},
  {0x72adab793fdf18c4, 0x2f4d5cdd1fc580ab, 0x8e78f799044e6b42},
  {0xb0301d0abb86ee1b, 0x0b03fecdf0718bba, 0xef3ae01f4ffad554},
  {0x04cb5708577b8af1, 0x37b5fe76883f8bb0, 0x691cbc2f7de2ab22},
  {0xc9a4330a531d32fe, 0xdcc86eb2d4c08af9, 0xd30b48e2bd88e41d},
  {0xe66b5fb00ef63d3e, 0xa1fc1b04479fb810, 0xa68430027a6af16f},
  {0xffb5a6716015be0a, 0x8eac46ed163b76a4, 0x0d1abc31bbbb98c9},
  {0xfc0f9cd7caf15eba, 0x9013700612b13109, 0x87793d4f60633699},
  {0x6dd597ad2f23224f, 0x40963ea9ab8b79ac, 0xd2484d2ced589f83},
  {0x89ba82b44b6e7e74, 0x6f352840b5a8feef, 0x971d1ce095ff8edf},
  {0x85f1b9818a45e598, 0xeeb1c2bd096425dd, 0x6d1fb249d62a0e2b},
  {0x3f710f0d6b2e2c70, 0xa36493ef0035694f, 0xbae56156926fe0ed},
  {0xb707be0ab01ca6de, 0x4ee8789b4ac2bed7, 0x83965fad9105b1b6},
  {0x6a05ee8fb6050e0b, 0x200941972e54d73c, 0xab8fdb217dda7a2a},
  {0x028bf8a1cc8bdf21, 0x7e0fd4975d79693e, 0xcaf8f4dc1339f119},
  {0x6303ab50718987c4, 0x8db8223eeca825a1, 0xc7941557693fa64c},
  {0x6f3000dba64f35d1, 0x972e853649441625, 0x3caa906ee4f54108},
  {0xcfb24866307e8998, 0xd40cb65f90f139bd, 0xdf425996d5a9e020},
  {0xedc645196f7dfbb9, 0xd224206288b023f1, 0x518dde65100bb69b},
  {0xf0c3874ba77c394d, 0x098962cb7330a7a4, 0x874f38a66171de44},
  {0xbecb95808a5c9cff, 0x568509fcf2ea314f, 0xdeab912accfe95cc},
  {0x25d8da4ce06f429f, 0x51b44099c67b64eb, 0x052242577e789d7e},
  {0x3376e7cdc4d9824e, 0xb778e619f0edceed, 0x2cd00dc17cf1d30e},
  {0xdb6dc9d1b3ad4dfe, 0x1f244bb94142f91d, 0xdecca2874ec2a47a},
  {0x74b923c6a9693e93, 0x5d4c863f2c94d832, 0x242f03d4b540d50c},
  {0xed04b59a202d755c, 0xe3abf94087eb0dc2, 0xcbc6d22fa786434a},
  {0xc1dcf73615e02f0a, 0x4b63ad5961b88083, 0xb7a276cf1c148595},
  {0xc86c8e921bf3499b, 0x2ae465eb554b3d90, 0x79e2ea2052ca4e17},
  {0xfd5a9cde2adca500, 0x6e765c3ce4eb797e, 0xeb0e3ce70b3d0a23},
  {0x700f13beef8274e8, 0x50dafb37bddd129d, 0x5139fd60c9b491e0},
  {0x34083eaf8d3b9468, 0xadf116f4d47d930b, 0x59d0976f04f784b9},
  {0x1a087167b95cd45d, 0x929f4ca05ee716ac, 0x6c28f298b1ee7bf2},
  {0x56f6dd8e3c6f4098, 0x9f75674b8d1c5b01, 0xfa355ed59ff824f7},
  {0x30956382df9e47be, 0x80f5a39d212f48fe, 0x9facf644e763ae45},
  {0x315f80daf569694e, 0x6ce94814a257dd2b, 0x59b48f847af2393a},
  {0x91393017d66cba2f, 0xfae3e95f2f24f7a2, 0xaaee212bdbf7da2b},
  {0x43502408e1159345, 0xef9d36d3ce81733f, 0x34efab8080577d07},
  {0xbdc0baa66c334c8c, 0x405df4a765913b05, 0x70549344d1dfbad6},
  {0x1bdaadc559361006, 0xe100634facbedc04, 0xa2da0a6b6c2894dc},
  {0x8bbe50da0f170659, 0xa3827f52be517a90, 0xeb46a16cfa655c06},
  {0xfb532d771fc7b796, 0xaeb3faff09435d73, 0x929dc90cbf84f559},
  {0x371cde18c34f506a, 0x741305e9e856198b, 0x20664bddea3f0570},
  {0x4873bc1118e95c01, 0xf0462f2a58b47087, 0xce3c0fcb853e04f8},
  {0x2251430dda00a7ac, 0xf8e027a578867833, 0x20e852720eb9892d},
  {0x1141eb1f4ec50e4f, 0xb8e785d8e0ae3f0f, 0xda92c858035e2a41},
  {0x4c03615545af2236, 0x9ff1da4b31c64c50, 0xa7eefc7b8c75c193},
  {0x22adaca89271a5e4, 0x58ab0e930bc20cb5, 0x0012140ed0f15274},
  {0x8f6d30c08227beba, 0x50cb29c9cf0e2870, 0xb7f2f838428535fe},
  {0x380a59640778bc17, 0xa90fb3d1aae16b26, 0x182f0c182e12af36},
  {0xa91c84520b234951, 0x25fa212c606dd66d, 0x39aa95584b867540},
  {0xad19511580a2cdc1, 0x53b5b09f209120c6, 0x863dc796671b58ff},
  {0x39e4e257a390c575, 0x4f6052ebfe3aa085, 0xe60b2eb049713329},
  {0x1dc369dac296a0e0, 0x907dccf3ac7586aa, 0xe2393c3de1774815},
  {0xbd722c8aa700b5eb, 0x860a06ea3cad5219, 0x964cc23df4eddc12},
  {0x39b0108d18df0696, 0x1358ebcd50514ea0, 0x8a7ae8b55881ff86},
  {0x19dd6bfb613d784f, 0x7da2ecbe71b0b8cd, 0xe679e9c9e32e2b20},
  {0x8f92f0182d751b22, 0x51b53bb4a52c1881, 0x5910036c68d41866},
  {0xcde2dca38ac9641d, 0x82e9f07716796c21, 0x787e06661630eead},
  {0x3276086adfd95e40, 0x1d7c1ff70b16675f, 0xeaf39afa61ca2202},
  {0x3722a9d94434ecc8, 0x11b9159cd08f7a2c, 0xf35ff5d085f553fc},
  {0x661e42a454d18d23, 0x1e000df53eaeff34, 0xd229adf6ec45e967},
  {0xcbdb5ac79b3fc8ad, 0x930c913c7e33d520, 0x69f7c1bd0405586b},
  {0x80dd469940e2b15b, 0xc20cfe7aee4c1e5e, 0x0d07abc632f77221},
  {0x7a9fbaa29f49f1c3, 0xf94c1c07de0a8bc3, 0x9aaf2cddb136212d},
  {0x0f9c909b428b1817, 0x2257a5fba175ae5a, 0x648b735311affb7e},
  {0xa12b4dd18957e59a, 0xe66e441e33a6d71b, 0xafd5b76a9fc305c3},
  {0xdcf857a4a10a1c4d, 0x9cc25bb23ad80208, 0xc6588927de400316},
  {0x814b0b21ef612d6e, 0x6d692ef043a0e442, 0x65677e4ba8e461b0},
  {0xff8ff4a93f138573, 0x2d2d3d6b22fd8467, 0x2823a1ba67a6dfb4},
  {0x04af5e90c49fa1c4, 0xe538c144b5bef7d2, 0x10966b93eb02042d},
  {0x1744d090fa545f4f, 0x395a6eccd01d3773, 0xcbe58f44b73e5b60},
  {0x9c91f2009f4c9d7b, 0x92b5bca14d172194, 0x75266b072bfa5b72},
  {0x7474496bb48bf94d, 0x916e87f02d1f86c2, 0x7151118d4c7471cb},
  {0x1f933215db8a5175, 0xcbfe4051f51e0b5a, 0x5d5bfe1da65ca678},
  {0x576c87a1289c7577, 0x0f9d454eab815931, 0x08faea77fbcff874},
  {0xdf94cecbd2fb2c04, 0x465f542ac526199b, 0x9ad188799bbd9c62},
  {0xc7cb4bbfe62e3641, 0x7d7f6add6eef7f71, 0x4576b8185d05003f},
  {0xdfdaa96f16ce902a, 0x6a3df40f7a14fd90, 0x58e594ab2a7487e1},
  {0xcad4600541e08342, 0x40435201ac7e8545, 0x78f7a1ec78ceed18},
  {0x16997eb28160948f, 0xe1f9bea5db05784a, 0xa6b74ef5e5c8d3c4},
  {0x1e878c9a8ef52568, 0x029208c11ef05120, 0xd2fe1d60995ca403},
  {0x6268201df5734d5e, 0x36357012da5af3c5, 0x8e6faed5300b52e8},
  {0x5914215e70f25cc7, 0xd65a14c79c8a7f8b, 0xfb2efa12454c19dd},
  {0x11adf7f337c7d253, 0x80bad2b28b2b2a34, 0x55e0ab9b89172fc1},
  {0x90fc6b476e045db5, 0x859dfa297ec7e24c, 0x82a61faa37181be4},
  {0x51113686baea7258, 0xc9dcdb00f87e1166, 0x3cb1861421341c00},
  {0xfc153a835e0bf4e3, 0x5940b00d92214891, 0xee9a0b308beeb9e0},
  {0x7075c23347cd240a, 0x2f7604ca493dafa9, 0x9e3088c4980c463c},
  {0x09fd27d8cde4c163, 0xb00e26ff708770a4, 0xa2d2efed461e4396},
  {0x41baf9b048a0b557, 0x7d5b7dc535b17426, 0xfa93a6a7ec72ac1a},
  {0x3a703cc711258934, 0x6f81b868bc42083d, 0x5d232715d3270814},
  {0xfc15c5c5106a0361, 0xf3a83f039fae8f0d, 0x459905dabd340368},
  {0x214b0123494f2f65, 0xd351736c415c6533, 0xb7e6ac1e18a331f6},
  {0xf9d3d7f6ad948aff, 0x016f0f32ea8332ed, 0x1d345f32b0152c2a},
  {0x6573f41d6b74936d, 0x398dbbab5cb16835, 0xdfe65e29fef69276},
  {0xd21f87490ee554c5, 0x6413a3a9e5cc798e, 0x05357d5aa91e38f1},
  {0xbd09d9a7603c43ba, 0xdccf50c80ecfd9b8, 0x498bab3e42842fa0},
  {0xa3f8d608b8b9ae7a, 0xef7102a26cef9c2a, 0xbff758cdc1d8112d},
  {0xa3a4472d60252712, 0xc4b79ba13f79d0f4, 0x58e10b516604a9a4},
  {0x74c056f12a356eeb, 0xad2f68e0d343a00f, 0x3c15d61f8d582ccd},
  {0x01f19baae668b71d, 0xc79e3eba618e7bde, 0x60996351794ae4dc},
  {0x1600dbe5e7cf289d, 0x73861c3fb6f1e352, 0xcb578b06260455d6},
  {0xe92c502943293b4c, 0x0ac0a66e843b99dd, 0x0c8489978b7ccbb2},
  {0xc43a0acea1033929, 0x9b837de223ec82ce, 0x342d3819fe1a7928},
  {0x9a7e4dd0cf3af020, 0x46ef35683bf279ac, 0x1022763b53f23a57},
  {0xb3ae222b2b7b03df, 0x0dd172bdb52a32ac, 0x20befbbc916aa27b},
  {0xaab8fb211f5e750f, 0x829bca74378212b3, 0xd367ee00354f670c},
  {0x2a6add82d80e128d, 0x831aacfe582a4dc7, 0x0940d2a79c0f7e56},
  {0x52403ab8f16ac76a, 0xfeb1de019dc34aeb, 0x45c99b56a145db2e},
  {0x059657c1bdc18dea, 0xa1db080b04a11ff7, 0xa71ed9a51d016835},
  {0x3eb2f17f749dcb28, 0xa57587841bf8cced, 0xdb7dbe728a8f5d08},
  {0x544b4fa72708afe0, 0x44fa28a25c4d2012, 0xa20b88c9a6e94976},
  {0x43e2b0349aa3a7e1, 0x7608a373628e4fc5, 0xdb4b7feba7dab3bf},
  {0x4111ff461bebead8, 0x6cb9e56b43bb3fb7, 0xfe34c29c3fae4f9d},
  {0xa37c54f31d49c193, 0x8464530446a9e95c, 0xb2d4eb3d03392d78},
  {0xe78074d60a7b79c9, 0x209b50a8a3a9f2f9, 0x206f99ec182524b9},
  {0xb54d2ec2cc573308, 0x0d4b218acd073e31, 0x877e22700ce4476e},
  {0x81ea3ef2199901d6, 0x9b8defc45868c272, 0xd348b458758fd79e},
  {0x007c7d730883c867, 0x5ae887e6dd713d28, 0x54e669fe282922b3},
  {0x28827aee678ccec6, 0xe701812abf6f2978, 0x87f92a53bd18e80d},
  {0x6971f7a876e3074a, 0x7d145fd6450a619e, 0x488f92afcdc03fd7},
  {0xb92c72ca62b49ec6, 0x111961225f7a036d, 0x4140d1cc584c1a46},
  {0x917e6280ceaf3b04, 0xa3e12fa9e3a138d2, 0x6809f1ce31242d0f},
  {0x9b668683995d2c66, 0x8c095aa7c50b740f, 0x09a970bf96aed6f6},
  {0x108a990e45819b1c, 0xcdf6384bfa45e992, 0x92604244ba5bcc3f},
  {0xd74f55323f2fa550, 0x684457fe3b2c0986, 0x4812952573b499f5},
  {0x59e3bae0c80bc917, 0x5571248311de3e65, 0xfba283be49907b76},
  {0x2723defe5b735a40, 0x113fd11a5579bd68, 0x83499dba1e0769f2},
  {0xd30b6f24d0402484, 0xd00dece1c6270a80, 0xc30fc709ea7fc574},
  {0x099a2f0ce01c577f, 0x6fb48b86f1876de2, 0x53527636e8eef285},
  {0x6458db193303938d, 0x72ff4c083db17970, 0xff19be5040d67848},
  {0x721476faaa10839b, 0x94fa67104b3a8efa, 0x24aab7bae59accb4},
  {0xbdc6051e6f934a56, 0x44f76ca50b084e8a, 0x9a65518872864f41},
  {0xa6d402ec65d67098, 0x25917c9d0e078f98, 0xbff223b6ac74fa43},
  {0xdeefc303c037f10c, 0x489321abcfb05b0b, 0xca076b4ec9c9049b},
  {0xd2c7fbd5568835f2, 0x612ab11f51236fc9, 0x0bd76bd0a5b5ee37},
};

void generate_matrices_L_and_U(const uint8_t* iv, GF** matrix_A, GF vector_b);
void generate_matrix_LU(const uint8_t* iv, GF** matrix_A, GF vector_b);
void compute_sbox_outputs(const uint8_t* pt, GF* sbox_outputs);

void aim(const uint8_t* pt, const uint8_t* iv, uint8_t* ct);
void aim_mpc(const uint8_t* pt, const GF** matrix_A,
             const GF vector_b, const uint8_t* ct,
             const size_t num_parties, GF *z_shares, GF *x_shares);

#endif // AIM192_H
